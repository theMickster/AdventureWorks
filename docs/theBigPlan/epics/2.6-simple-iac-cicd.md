# Epic 2.6: Simple IaC + CI/CD

**Initiative**: [Initiative 2 - Event-Driven Microservices + Production Infrastructure](../initiatives/02-event-driven-microservices-infrastructure.md)
**Timeline**: Weeks 15-16
**Estimated Story Points**: 100-120
**Status**: Not Started

---

## Epic Overview

**As a DevOps engineer, I want Infrastructure as Code (Bicep) and CI/CD pipelines (GitHub Actions), so that the application can be deployed to Azure reliably and repeatedly.**

---

## Epic Success Criteria (Gherkin Format)

**Given** IaC and CI/CD are configured
**When** I push code to main branch
**Then**:
- ✅ GitHub Actions builds and tests the code
- ✅ If tests pass, deploys to Azure
- ✅ All Azure resources created via Bicep
- ✅ Secrets managed via Key Vault
- ✅ Deployment is idempotent

---

## Features

### Feature 2.6.1: Bicep Module for App Service
**As a developer, I want Bicep template for API App Service.**

**Acceptance Criteria**: Template creates App Service Plan, App Service, configures environment variables, managed identity.
**Key Files**: `infrastructure/bicep/modules/app-service.bicep`
**Estimated Story Points**: 13

---

### Feature 2.6.2: Bicep Module for Static Web App
**As a developer, I want Bicep template for Frontend Static Web App.**

**Acceptance Criteria**: Template creates Static Web App, configures custom domain (optional), build settings.
**Key Files**: `infrastructure/bicep/modules/static-web-app.bicep`
**Estimated Story Points**: 13

---

### Feature 2.6.3: Bicep Module for Function Apps
**As a developer, I want Bicep templates for Azure Functions.**

**Acceptance Criteria**: Templates for: Document Processing, Fraud Detection, Integration Function, storage accounts, managed identities.
**Key Files**: `infrastructure/bicep/modules/function-app.bicep`
**Estimated Story Points**: 13

---

### Feature 2.6.4: Bicep Module for SQL Database
**As a developer, I want Bicep template for Azure SQL.**

**Acceptance Criteria**: Template creates SQL Server, SQL Database, firewall rules, managed identity for API.
**Key Files**: `infrastructure/bicep/modules/sql-database.bicep`
**Estimated Story Points**: 13

---

### Feature 2.6.5: Bicep Module for Key Vault
**As a developer, I want Bicep template for Key Vault.**

**Acceptance Criteria**: Template creates Key Vault, access policies for services, secrets configuration.
**Key Files**: `infrastructure/bicep/modules/key-vault.bicep`
**Estimated Story Points**: 8

---

### Feature 2.6.6: Bicep Module for Application Insights
**As a developer, I want Bicep template for Application Insights.**

**Acceptance Criteria**: Template creates App Insights, Log Analytics workspace, configured for all services.
**Key Files**: `infrastructure/bicep/modules/app-insights.bicep`
**Estimated Story Points**: 8

---

### Feature 2.6.7: Main Bicep Template
**As a developer, I want main template orchestrating all modules.**

**Acceptance Criteria**: Main template imports modules, parameterized for dev/prod, outputs resource names/URLs.
**Key Files**: `infrastructure/bicep/main.bicep`, `infrastructure/bicep/main.parameters.dev.json`
**Estimated Story Points**: 13

---

### Feature 2.6.8: GitHub Actions for API Build and Test
**As a developer, I want workflow building and testing API.**

**Acceptance Criteria**: Workflow triggers on push, runs dotnet build, runs unit tests, runs integration tests.
**Key Files**: `.github/workflows/api-ci.yml`
**Estimated Story Points**: 8

---

### Feature 2.6.9: GitHub Actions for Frontend Build and Test
**As a developer, I want workflow building and testing Frontend.**

**Acceptance Criteria**: Workflow triggers on push, runs npm install, runs ng build, runs unit tests.
**Key Files**: `.github/workflows/frontend-ci.yml`
**Estimated Story Points**: 8

---

### Feature 2.6.10: GitHub Actions for Azure Deployment
**As a developer, I want workflow deploying to Azure.**

**Acceptance Criteria**: Workflow deploys Bicep templates, deploys API to App Service, deploys Frontend to Static Web App, deploys Functions.
**Key Files**: `.github/workflows/azure-deploy.yml`
**Estimated Story Points**: 13

---

## Epic Summary

### Total Estimated Story Points: 110

### Key Deliverables
- ✅ Complete Bicep templates for all Azure resources
- ✅ GitHub Actions workflows for CI/CD
- ✅ Automated deployment to Azure
- ✅ Secrets managed via Key Vault
- ✅ Idempotent infrastructure deployment

---

**Document Version**: 1.0
**Last Updated**: 2026-01-17
**Status**: Ready for Implementation
