# Epic 2.1: Testing Foundation

**Initiative**: [Initiative 2 - Event-Driven Microservices + Production Infrastructure](../initiatives/02-event-driven-microservices-infrastructure.md)
**Timeline**: Week 9
**Estimated Story Points**: 60-80
**Status**: Not Started

---

## Epic Overview

**As a development team, we want a comprehensive testing foundation with unit tests (TDD), API integration tests, E2E tests (Playwright), and load tests (k6), so that we can build with confidence and catch regressions early.**

---

## Epic Success Criteria (Gherkin Format)

**Given** the Testing Foundation is complete
**When** we develop features
**Then** we should have:
- ✅ Unit test patterns documented and demonstrated (TDD approach)
- ✅ API integration tests using WebApplicationFactory
- ✅ E2E test framework with Playwright configured
- ✅ Load testing setup with k6
- ✅ Test data builders and fixtures
- ✅ All tests running in CI pipeline

---

## Features

### Feature 2.1.1: TDD Unit Test Patterns
**As a developer, I want documented TDD patterns for unit tests.**

**Acceptance Criteria**: Document patterns for: Arrange-Act-Assert, test naming conventions, mocking strategies, test builders.
**Key Files**: `docs/testing/unit-test-patterns.md`
**Estimated Story Points**: 8

---

### Feature 2.1.2: API Integration Tests Setup
**As a developer, I want integration tests for API endpoints using WebApplicationFactory.**

**Acceptance Criteria**: Configure WebApplicationFactory, in-memory database, example tests for Stores API.
**Key Files**: `tests/AdventureWorks.Api.IntegrationTests/SalesControllerTests.cs`
**Estimated Story Points**: 13

---

### Feature 2.1.3: Playwright E2E Framework Setup
**As a developer, I want Playwright configured for E2E testing.**

**Acceptance Criteria**: Install Playwright, configure for Chromium, example test for login flow.
**Key Files**: `tests/AdventureWorks.E2E/playwright.config.ts`
**Estimated Story Points**: 13

---

### Feature 2.1.4: Critical User Flow E2E Tests
**As a developer, I want E2E tests for critical flows.**

**Acceptance Criteria**: Tests for: Login flow, Create store flow, View dashboard flow.
**Estimated Story Points**: 13

---

### Feature 2.1.5: k6 Load Testing Setup
**As a developer, I want load tests with k6.**

**Acceptance Criteria**: Install k6, example load test for Stores API (GET and POST), thresholds for response time and success rate.
**Key Files**: `tests/AdventureWorks.LoadTests/stores-api.js`
**Estimated Story Points**: 13

---

### Feature 2.1.6: Test Data Builders
**As a developer, I want test data builders for creating test entities.**

**Acceptance Criteria**: Builder classes for: Store, SalesPerson, Employee, Department with fluent API.
**Key Files**: `tests/AdventureWorks.Tests.Shared/Builders/StoreBuilder.cs`
**Estimated Story Points**: 8

---

### Feature 2.1.7: CI Integration for Tests
**As a developer, I want all tests running in CI pipeline.**

**Acceptance Criteria**: GitHub Actions workflow runs unit tests, integration tests, E2E tests (on PR), load tests (manual trigger).
**Key Files**: `.github/workflows/test.yml`
**Estimated Story Points**: 8

---

## Epic Summary

### Total Estimated Story Points: 76

### Key Deliverables
- ✅ TDD patterns documented
- ✅ API integration tests with WebApplicationFactory
- ✅ Playwright E2E framework with critical flow tests
- ✅ k6 load testing setup
- ✅ Test data builders
- ✅ CI pipeline running all tests

---

**Document Version**: 1.0
**Last Updated**: 2026-01-17
**Status**: Ready for Implementation
